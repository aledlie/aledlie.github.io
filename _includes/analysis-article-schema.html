{% if page.schema_type == 'AnalysisNewsArticle' %}
{% comment %}
AnalysisNewsArticle Schema - For data-driven analysis and expert commentary
Conditional include based on page.schema_type front matter
References unified knowledge graph entities via @id

Usage in post front matter:
---
schema_type: AnalysisNewsArticle
schema_about: "Web Performance Optimization"
schema_dateline: "Web Development, November 2025"
---

Note: AnalysisNewsArticle is "pending" status in Schema.org but actively used
Best for: Performance analysis, benchmark reports, expert technical analysis
{% endcomment %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "AnalysisNewsArticle",
  "@id": "{{ page.url | absolute_url }}#analysisnewsarticle",

  "headline": {{ page.title | jsonify }},
  "description": {{ page.excerpt | default: page.description | default: site.description | strip_html | truncate: 160 | jsonify }},

  {% comment %}NewsArticle-specific property{% endcomment %}
  {% if page.schema_dateline -%}
  "dateline": {{ page.schema_dateline | jsonify }},
  {% endif -%}

  {% comment %}Article properties{% endcomment %}
  {% if page.schema_section -%}
  "articleSection": {{ page.schema_section | jsonify }},
  {% elsif page.categories -%}
  "articleSection": {{ page.categories | jsonify }},
  {% endif -%}

  "articleBody": {{ page.content | strip_html | truncate: 5000 | jsonify }},
  "wordCount": {{ page.content | strip_html | number_of_words }},

  {% comment %}Author and publisher via @id references{% endcomment %}
  "author": {
    "@id": "{{ site.url }}#person"
  },
  "publisher": {
    "@id": "{{ site.url }}#person"
  },

  {% comment %}Dates{% endcomment %}
  "datePublished": "{{ page.date | date_to_xmlschema }}",
  {% if page.last_modified_at -%}
  "dateModified": "{{ page.last_modified_at | date_to_xmlschema }}",
  {% else -%}
  "dateModified": "{{ page.date | date_to_xmlschema }}",
  {% endif -%}

  {% comment %}Image{% endcomment %}
  "image": {
    "@type": "ImageObject",
    "url": "{{ page.header.image | default: page.header.overlay_image | default: page.header.teaser | default: site.og_image | absolute_url }}",
    "width": 1200,
    "height": 630
  },

  {% comment %}Main entity of page{% endcomment %}
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ page.url | absolute_url }}"
  },

  "url": "{{ page.url | absolute_url }}",

  {% comment %}Keywords and tags{% endcomment %}
  {% if page.schema_keywords -%}
  "keywords": {{ page.schema_keywords | join: ", " | jsonify }},
  {% elsif page.tags -%}
  "keywords": {{ page.tags | join: ", " | jsonify }},
  {% endif -%}

  {% comment %}Language{% endcomment %}
  "inLanguage": "{{ site.locale | default: 'en-US' }}",

  {% comment %}Reading time and voice search{% endcomment %}
  {% assign words = page.content | strip_html | number_of_words -%}
  {% assign minutes = words | divided_by: 200 -%}
  "timeRequired": "PT{{ minutes | at_least: 1 }}M",
  "speakable": {
    "@type": "SpeakableSpecification",
    "cssSelector": [".page__title", ".page__lead", ".page__content p:first-of-type"]
  },

  {% comment %}Part of blog{% endcomment %}
  "isPartOf": {
    "@id": "{{ site.url }}#blog"
  },

  {% comment %}About - subject matter of analysis{% endcomment %}
  {% if page.schema_about -%}
  "about": [
    {
      "@type": "Thing",
      "name": {{ page.schema_about | jsonify }}
    }
  ],
  {% endif -%}

  {% comment %}Backstory - context for the analysis (optional){% endcomment %}
  {% if page.schema_backstory -%}
  "backstory": {{ page.schema_backstory | jsonify }},
  {% endif -%}

  {% comment %}Mentions - technologies, packages, and tools analyzed{% endcomment %}
  {% if page.schema_mentions -%}
  "mentions": [
    {% for mention in page.schema_mentions -%}
    {
      "@type": "{{ mention.type | default: 'SoftwareApplication' }}",
      "name": {{ mention.name | jsonify }}
      {% if mention.url -%}
      ,"url": {{ mention.url | jsonify }}
      {% endif -%}
      {% if mention.description -%}
      ,"description": {{ mention.description | jsonify }}
      {% endif -%}
    }{% unless forloop.last %},{% endunless %}
    {% endfor -%}
  ],
  {% endif -%}

  {% comment %}Creator (same as author for articles){% endcomment %}
  "creator": {
    "@id": "{{ site.url }}#person"
  }
}
</script>
{% endif %}
